<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--=============== FLATICON ===============-->
    <link rel="stylesheet" href="" />

    <!--=============== SWIPER CSS ===============-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />

    <!--=============== CSS ===============-->
    <link rel="stylesheet" href="assets/css/info_account.css" />

    <title>My Account</title>
    <link rel="icon" href="assets/img/shop.png" type="image-icon" />
  </head>
  <body>
    <!--=============== HEADER ===============-->
    <header class="header">
      <div class="header_top">
        <div class="header_container container">
          <div class="header_contact">
            <span>(+84) 565 077 172</span>
            <span>Our contact</span>
          </div>
          <p class="header_alert-new">Siêu sale đón Tết - Ưu đãi đầu năm</p>
          <a href="" class="header_top-action"> Login / Sign in </a>
        </div>
      </div>

      <nav class="nav container">
        <a href="index.html" class="nav_logo">
          <img src="assets/img/logo.svg" alt="logo" class="nav_logo-img" />
        </a>
        <div class="nav_menu" id="nav-menu">
          <ul class="nav_list">
            <li class="nav_item">
              <a href="" class="nav_link">Home</a>
            </li>

            <li class="nav_item">
              <a href="shop.html" class="nav_link">Shop</a>
            </li>

            <li class="nav_item">
              <a href="" class="nav_link">My Account</a>
            </li>

            <li class="nav_item">
              <a href="" class="nav_link">Blog</a>
            </li>

            <li class="nav_item">
              <a href="" class="nav_link">Login</a>
            </li>
          </ul>
          <div class="header_search">
            <input
              type="text"
              placeholder="Tìm kiếm sản phẩm"
              class="form_input"
            />

            <button class="search_btn">
              <img src="assets/img/search.png" alt="seacrh" />
            </button>
          </div>
        </div>
        <div class="header_user-action">
          <a href="#" class="header_action-btn">
            <img src="assets/img/icon-heart.svg" alt="heart" />
            <span class="count">3</span>
          </a>

          <a href="#" class="header_action-btn">
            <img src="assets/img/icon-cart.svg" alt="heart" />
            <span class="count">3</span>
          </a>
        </div>
      </nav>
    </header>
    <div class="profile-container">
    <div class="avatar-container" onclick="document.getElementById('fileInput').click();">
        <img id="avatarPreview" class="avatar" src="assets/img/user.png" alt="Avatar">
    </div>
    <input type="file" id="fileInput" accept="image/*" onchange="previewImage(event)">
    
    <script>
    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const avatar = document.getElementById("avatarPreview");
            avatar.src = reader.result;
        }
        reader.readAsDataURL(event.target.files[0]);
    }
    </script>

      <div class="account-form">
        <h2>Thông Tin Tài Khoản</h2>
        <form id="updateForm">
          <label>Họ và tên:</label>
          <input type="text" id="fullname" />

          <label>Email:</label>
          <input type="email" id="email" disabled />

          <label>Ngày sinh:</label>
          <input type="date" id="dob" />

          <label>Số điện thoại:</label>
          <input type="text" id="phone" />

          <label>Địa chỉ:</label>
          <input type="text" id="address" />

          <button type="submit">Cập nhật thông tin</button>
        </form>
      </div>
    </di>
</div>
    <!--=============== NEWSLETTER ===============-->
    <section class="newsletter section home_newletter">
      <div class="newsletter_container container">
        <h3 class="newsletter_title flex">
          <img
            src="assets/img/icon-email.svg"
            alt=""
            class="newsletter_icon"
          />Sign up to Newsletter
        </h3>
        <p class="newsletter_desciption">
          ...And receive to 100.000 VNĐ coupon for first shopping
        </p>
        <form action="" class="newsletter_form">
          <input
            type="text"
            placeholder="Enter your email"
            class="newsletter_input"
          />
          <button type="Submit" class="newsletter_btn">Subcribe</button>
        </form>
      </div>
    </section>

    <!--=============== FOOTER ===============-->
    <footer class="footer container">
      <div class="footer_container grid">
        <div class="footer_content">
          <a href="index.html" class="footer_logo">
            <img src="assets/img/logo.svg" alt="logo" class="footer_logo-img" />
          </a>
          <h4 class="footer_contact">Contact</h4>

          <p class="footer_description">
            <span>Address:</span> Số 234, Hoàng Quốc Việt, Bắc Từ Liêm, Hà Nội
          </p>
          <p class="footer_description">
            <span>Phone:</span> (+84) 565 077 172
          </p>
          <p class="footer_description">
            <span>Time:</span> 9:00 - 20:00, Thứ 2 - Thứ 7
          </p>

          <div class="footer_social">
            <h4 class="footer_subtitle">Follow me</h4>
            <div class="footer_social-link">
              <a href="">
                <img
                  src="assets/img/icon-facebook.svg"
                  alt="facebook"
                  class="footer_social-icon"
                />
              </a>
              <a href="">
                <img
                  src="assets/img/icon-twitter.svg"
                  alt="facebook"
                  class="footer_social-icon"
                />
              </a>
              <a href="">
                <img
                  src="assets/img/icon-instagram.svg"
                  alt="facebook"
                  class="footer_social-icon"
                />
              </a>
              <a href="">
                <img
                  src="assets/img/icon-pinterest.svg"
                  alt="facebook"
                  class="footer_social-icon"
                />
              </a>
              <a href="">
                <img
                  src="assets/img/icon-youtube.svg"
                  alt="facebook"
                  class="footer_social-icon"
                />
              </a>
            </div>
          </div>
        </div>

        <div class="footer_content">
          <h3 class="footer_title">Address</h3>
          <ul class="footer_links">
            <li><a href="" class="footer_link">Blog</a></li>
            <li><a href="" class="footer_link">Privacy Policy</a></li>
            <li><a href="" class="footer_link">Terms & Conditions</a></li>
            <li><a href="" class="footer_link">Contact </a></li>
            <li><a href="" class="footer_link">Support</a></li>
          </ul>
        </div>
        <div class="footer_content">
          <h3 class="footer_title">My Account</h3>
          <ul class="footer_links">
            <li><a href="" class="footer_link">Sign in</a></li>
            <li><a href="" class="footer_link">View cart</a></li>
            <li><a href="" class="footer_link">Track My Order</a></li>
            <li><a href="" class="footer_link">Help</a></li>
            <li><a href="" class="footer_link">Order</a></li>
          </ul>
        </div>
        <div class="footer_content">
          <h3 class="footer_title">Secured Payment Gateways</h3>
          <img src="assets/img/payment-method.png" alt="" class="payment_img" />
        </div>
      </div>
      <div class="footer_bottom">
        <p class="copyright">@Copyright; 2025. All right reserved</p>
      </div>
    </footer>

    <!--=============== SWIPER JS ===============-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!--=============== MAIN JS ===============-->
    <script src=""></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("/getUserInfo")
          .then((response) => response.json())
          .then((user) => {
            if (user) {
              document.getElementById("fullname").value = user.fullname;
              document.getElementById("email").value = user.email;
              document.getElementById("dob").value = user.dob;
              document.getElementById("phone").value = user.phone;
              document.getElementById("address").value = user.address;
            }
          })
          .catch((error) =>
            console.error("Lỗi khi lấy dữ liệu người dùng:", error)
          );
      });

      document
        .getElementById("updateForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Chặn form submit mặc định

          let fullname = document.getElementById("fullname").value.trim();
          let dob = document.getElementById("dob").value;
          let phone = document.getElementById("phone").value.trim();
          let address = document.getElementById("address").value.trim();

          if (!fullname || !dob || !phone || !address) {
            alert("Vui lòng điền đầy đủ thông tin trước khi cập nhật!");
            return;
          }

          let userData = {
            fullname: fullname,
            dob: dob,
            phone: phone,
            address: address,
          };

          fetch("/updateUserInfo", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(userData),
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                alert("Cập nhật thông tin thành công!");
              } else {
                alert("Cập nhật thất bại, vui lòng thử lại!");
              }
            })
            .catch((error) =>
              console.error("Lỗi khi cập nhật thông tin:", error)
            );
        });
    </script>
  </body>
</html>
